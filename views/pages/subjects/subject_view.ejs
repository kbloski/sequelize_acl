<%- include('../partials/head', { title: 'School View'}) %>
<body>
    <%- include('../partials/navbar') %>

    <h3>School:</h3>
    <table class="table">
        <tr>
            <th>_id</th>
            <td><%= subjectToView.id %></td>
        </tr>
        <tr>
            <th>Name</th>
            <td><%= subjectToView.name %></td>
        </tr>
        <tr>
            <th>Description:</th>
            <td><%= subjectToView.description %></td>
        </tr>
        <tr>
            <th>Teacher</th>
            <td> 
                <%= htmlHelper.getElValueFromArrById(teachers, subjectToView.teacherId, 'name') %>
            </td>
        </tr>
        <tr>
            <th>School</th>
            <td> 
                <%= htmlHelper.getElValueFromArrById(schools, subjectToView.schoolId, 'name') %>
            </td>
        </tr>
    </table>
    <a href="/subjects/edit/<%= subjectToView.id %>">
        <button class="btn">Edit subject</button>
    </a>
    <!-- students list -->
    <p>
        <% const students = subjectToView['Users'] %>
        <% if (students){ %>
        <table class="table">
            <tr>
                <th>_id</th>
                <th>Name</th>
                <th>Surname</th>
                <th>Role</th>
                <th>School</th>
                <th>Grade</th>
                <th>Actions</th>
            </tr>
            <% console.log('---------', students) %>
            <% for (const student of students) { %> 
                <% console.log(student['Grades'], '------------------------') %>
                <% console.log('-------------------------')%>

                <% const grades = student['Grades'] %>
                <% for (const grade of grades) { %> 

                    <tr>
                        <td><%= student.id %></td>
                        <td><%= student.name %></td>
                        <td><%= student.surname %></td>
                        <td><%= student.role %></td>
                        <td><%= student['School']?.name %></td>
                        <td><%= grade.grade %></td>
                        <td>
                            <a href="/grades/view/<%= grade.id %>">View</a>
                        </td>
                    </tr>
                <% } %>
            <% } %>

        </table>
        <% } %>
    </p>

    <%- include('../partials/footer') %>

</body>